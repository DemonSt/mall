(function(t){function e(e){for(var r,i,o=e[0],l=e[1],c=e[2],p=0,d=[];p<o.length;p++)i=o[p],n[i]&&d.push(n[i][0]),n[i]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);u&&u(e);while(d.length)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],r=!0,o=1;o<a.length;o++){var l=a[o];0!==n[l]&&(r=!1)}r&&(s.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},n={app:0},s=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var u=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1182:function(t,e,a){"use strict";var r=a("385d"),n=a.n(r);n.a},"14d4":function(t,e,a){"use strict";var r=a("c954"),n=a.n(r);n.a},"1fd9":function(t,e,a){"use strict";var r=a("e29e"),n=a.n(r);n.a},"1fef":function(t,e,a){"use strict";var r=a("24da"),n=a.n(r);n.a},"230d":function(t,e,a){},"24da":function(t,e,a){},"385d":function(t,e,a){},"3b07":function(t,e,a){},"3d0d":function(t,e,a){"use strict";var r=a("230d"),n=a.n(r);n.a},"56d7":function(t,e,a){"use strict";a.r(e);a("6b54"),a("cadf"),a("551c"),a("f751"),a("097d");var r=a("2b0e"),n=a("8c4f"),s=a("5c96"),i=a.n(s),o=(a("0fae"),a("f5df"),a("f771"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("GolbalNav"),a("div",[a("router-view")],1),a("GolbalFooter")],1)}),l=[],c=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"nav"},[a("div",{staticClass:"container"},[a("el-row",[a("el-col",{attrs:{span:12}},[a("router-link",{staticClass:"anchor",attrs:{to:"/"}},[t._v("首页")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("item")])],1),a("el-col",{staticClass:"text-right",attrs:{span:12}},[a("span",{staticClass:"anchor",on:{click:function(e){t.ui.showCart=!t.ui.showCart}}},[t._v("购物车 "),a("span",[t._v("("+t._s(t.cartCount)+")")])]),t.session.loggedIn()?a("span",[a("router-link",{staticClass:"anchor",attrs:{to:"/my/setting"}},[t._v(t._s(t._f("cut")(t.session.user("nickname")||t.session.user("mail")||t.session.user("phone"),6)))]),a("span",{staticClass:"anchor",on:{click:function(e){return t.session.logout()}}},[t._v("登出")])],1):a("span",[a("router-link",{staticClass:"anchor",attrs:{to:"/login"}},[t._v("登录")]),a("router-link",{staticClass:"anchor",attrs:{to:"/signup"}},[t._v("注册")])],1)])],1)],1),a("Cart",{directives:[{name:"show",rawName:"v-show",value:t.ui.showCart,expression:"ui.showCart"}],on:{close:function(){t.ui.showCart=!1}}})],1)},u=[],p=a("f499"),d=a.n(p);function m(t,e){localStorage.setItem(t,d()(e))}function f(t){var e=localStorage.getItem(t);return e?JSON.parse(e):null}var v={set:m,get:f};function h(){return localStorage.getItem("sessionId")}function _(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/";localStorage.setItem("sessionId",t),v.set("user",e),a&&("string"==typeof a?location.href=a:a())}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"/#/login";localStorage.removeItem("sessionId"),localStorage.removeItem("user"),location.reload(),location.href=t}function g(t){var e=v.get("user");return t?e[t]:e}function y(){var t=g();return t&&g().IS_ADMIN}var C={user:g,login:_,logout:b,loggedIn:h,isAdmin:y},w=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"cart"},[a("el-card",[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("我的购物车")]),a("span",{staticClass:"anchor",staticStyle:{float:"right"},on:{click:function(e){return t.$emit("close")}}},[t._v("关闭")])]),Object.keys(t.listCart).length<1?a("div",[t._v("暂无内容")]):t._e(),t._l(t.listCart,function(e,r){return a("el-row",{key:r},[a("el-col",{attrs:{span:4}},[a("ProductThumb",{staticStyle:{padding:".2em"},attrs:{data:e}})],1),a("el-col",{attrs:{span:10}},[t._v(t._s(e.product_snapshot.title))]),a("el-col",{staticClass:"cny hot text-center",attrs:{span:4}},[t._v(t._s(e.product_snapshot.price))]),a("el-col",{attrs:{span:6}},[a("div",{staticClass:"el-input-number el-input-number--mini"},[a("span",{staticClass:"el-input-number__decrease",attrs:{role:"button"},on:{click:function(a){return t.cartService.change(e.product_snapshot.id,-1)}}},[a("i",{staticClass:"el-icon-minus"})]),a("span",{staticClass:"el-input-number__increase",attrs:{role:"button"},on:{click:function(a){return t.cartService.change(e.product_snapshot.id,1)}}},[a("i",{staticClass:"el-icon-plus"})]),a("div",{staticClass:"el-input el-input--mini"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.count,expression:"v.count"}],staticClass:"el-input__inner",attrs:{type:"text",autocomplete:"off","aria-label":"描述文字",max:"Infinity",min:"1",role:"spinbutton","aria-valuemax":"10","aria-valuemin":"1","aria-valuenow":"4","aria-disabled":"undefined"},domProps:{value:e.count},on:{input:function(a){a.target.composing||t.$set(e,"count",a.target.value)}}})])])])],1)}),a("p",[t._v("\n      总价："),a("span",{staticClass:"hot cny"},[t._v(t._s(t.orderSum))])]),a("p",[a("el-button",{attrs:{type:"primary"},on:{click:t.createOrder}},[t._v("付款")])],1)],2)],1)},k=[],x=a("a4bb"),$=a.n(x),P=(a("ac6a"),a("cebc"));a("7514");function S(t){return"https://"+t._base_url+"/"+t._key}function q(t){return location.origin+"/"+t}function O(t){var e=[];for(var a in t)e.push(t[a]);return e}function B(t){return t.charAt(0).toUpperCase()+t.slice(1)}var N=a("0a0d"),j=a.n(N),F=a("bc3a"),I=a.n(F),U="f5ad1a69ae6c3a87125b43792b245bec1600de3a37764f885294f4556b1e151c";function M(t,e){var a=j()();return I.a.post("https://mock.biaoyansu.com/api/1/".concat(t),e,{headers:{"BIAO-MOCK-APP-KEY":U,"BIAO-MOCK-TIMESTAMP":a,"BIAO-MOCK-SIGNATURE":E(U,a)}}).then(function(t){return t.data})}function E(t,e){return btoa(t+e)}window.api=M;var D={},z=[],A={onChange:function(t){z.find(function(e){return e===t})||(z.push(t),this.callPool())},change:function(t,e,a,r,n){n||(n=C.user("id")),D[t]||(D[t]={product_id:t,count:0,product_snapshot:a,prop:r,user_id:n});var s=D[t].count+=e;s<=0&&this.remove(t),this.callPool(),this.sync()},callPool:function(){z.forEach(function(t){return t(Object(P["a"])({},D))})},get:function(){return Object(P["a"])({},D)},remove:function(t){delete D[t],this.callPool()},clear:function(){D={},this.callPool(),this.sync()},restore:function(){this.restoreLocal(),this.callPool()},restoreLocal:function(){D=v.get("cart")||{}},sync:function(){this.syncCloud(),this.syncLocal()},syncCloud:function(){var t=this;if(C.loggedIn()){var e=[];this.getCloud().then(function(a){var r=a.data||[];r.forEach(function(t){e.push(t.id)}),t.clearCloud(e),t.overwriteCloud()})}},restoreCloud:function(){var t=this;this.getCloud({key_by:"product_id"}).then(function(e){D=e.data,t.syncLocal(),t.callPool()})},overwriteCloud:function(){M("cart/create_many",{data:O(D)})},getCloud:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return M("cart/read",Object(P["a"])({},t,{where:{and:{user_id:C.user("id")}}}))},clearCloud:function(t){if(t.length)return M("cart/delete_many",{in:t})},syncLocal:function(){v.set("cart",D||{})},productCount:function(){return D=D||{},$()(D).length},isEmpty:function(){return!this.productCount()}};function V(){C.isAdmin()||(A.restore(),C.loggedIn()&&A.restoreCloud())}V();var L=A,R=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("img",{attrs:{src:t.url,alt:"缩略图"}})])},T=[],Y={productMainImg:"https://mock-cdn.biaoyansu.com/MOCK-FILE-5c654eff606727.74221044.jpeg"},G={props:["data"],computed:{url:function(){var t=this.data;t.main_img;return S(this.data.product_snapshot.main_img[0])}}},Q=G,X=a("2877"),K=Object(X["a"])(Q,R,T,!1,null,null,null),W=K.exports;function J(t,e){var a={detail:t};return a.sum=Z(a.detail),a.user_id=e,M("order/create",a).then(function(t){return t})}function Z(t){var e=0;return t.forEach(function(t){e+=t.product_snapshot.price*t.count}),e}var H={components:{ProductThumb:W},data:function(){return{listCart:{},cartService:L}},computed:{listCartArr:function(){return O(this.listCart)},orderSum:function(){return Z(this.listCartArr)}},mounted:function(){var t=this;console.log(L.get()),L.onChange(function(e){return t.listCart=e})},methods:{createOrder:function(){var t=this;J(this.listCartArr,C.user("id")).then(function(e){t.$router.push("/my/order/".concat(e.data.id)),L.clear(),t.$emit("close")})}}},tt=H,et=(a("790a"),Object(X["a"])(tt,w,k,!1,null,"74a81a26",null)),at=et.exports,rt={components:{Cart:at},mounted:function(){var t=this;L.onChange(function(e){t.cartCount=L.productCount()})},data:function(){return{cartCount:0,ui:{showCart:!1},session:C}}},nt=rt,st=(a("1182"),Object(X["a"])(nt,c,u,!1,null,"586900af",null)),it=st.exports,ot=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"footer"},[a("div",{staticClass:"container"},[a("el-row",[a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("Item")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("Item")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("Item")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("Item")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("Item")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("Item")])])],1)])},lt=[],ct={name:"GolbalFooter",components:{}},ut=ct,pt=Object(X["a"])(ut,ot,lt,!1,null,null,null),dt=pt.exports,mt={name:"app",components:{GolbalNav:it,GolbalFooter:dt}},ft=mt,vt=Object(X["a"])(ft,o,l,!1,null,null,null),ht=vt.exports,_t=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("RegularNav"),a("div",{staticClass:"container carousel"},[a("el-carousel",{attrs:{interval:4e3,type:"card",height:"200px"}},t._l(t.list_carousel,function(e){return a("el-carousel-item",{key:e.id},[a("router-link",{attrs:{to:"/product/"+e.id}},[a("img",{attrs:{src:t.fileUrl(e.carousel_img),alt:""}})])],1)}),1)],1),a("div",{staticClass:"container"},[a("h2",[t._v("新品")]),a("el-row",{staticClass:"card-list vartical-gutter",attrs:{gutter:10}},t._l(t.list_new,function(t){return a("el-col",{key:t,attrs:{span:6}},[a("ProductCard",{attrs:{data:t}})],1)}),1)],1),a("div",{staticClass:"container"},[a("h2",[t._v("促销")]),a("el-row",{staticClass:"card-list vartical-gutter",attrs:{gutter:10}},t._l(t.list_hot,function(t){return a("el-col",{key:t,attrs:{span:6}},[a("ProductCard",{attrs:{data:t}})],1)}),1)],1)],1)},bt=[],gt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"nav"},[r("div",{staticClass:"container"},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:6}},[r("router-link",{attrs:{to:"/"}},[r("div",{staticClass:"logo"},[r("img",{attrs:{src:a("edde"),alt:"Logo"}})])])],1),r("el-col",{staticClass:"text-right",attrs:{span:12}},[r("form",{staticClass:"search",on:{submit:function(e){return e.preventDefault(),t.toSearch(e)}}},[r("el-input",{attrs:{"suffix-icon":"el-icon-search"},model:{value:t.formSearch.keyword,callback:function(e){t.$set(t.formSearch,"keyword",e)},expression:"formSearch.keyword"}})],1)]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"logo"})])],1)],1)])},yt=[],Ct=a("7c04"),wt=a.n(Ct),kt={data:function(){return{formSearch:{},logo:wt.a}},methods:{toSearch:function(){this.$router.push({path:"/search",query:this.formSearch})}}},xt=kt,$t=(a("f2e1"),Object(X["a"])(xt,gt,yt,!1,null,"8e3380c4",null)),Pt=$t.exports,St=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"product-card"},[a("el-card",[a("router-link",{attrs:{to:"/product/"+t.data.id}},[a("img",{staticClass:"image",attrs:{src:t.data.main_img?t.fileUrl(t.data.main_img[0]):t.holder.productMainImg}})]),a("div",{staticStyle:{padding:"14px"}},[a("router-link",{attrs:{to:"/product/"+t.data.id}},[a("span",[t._v(t._s(t._f("cut")(t.data.title,27)))])]),a("p",[a("span",{staticClass:"hot cny"},[t._v(t._s(t.data.price))])])],1)],1)],1)},qt=[],Ot={props:["data"],data:function(){return{holder:Y}},methods:{fileUrl:S}},Bt=Ot,Nt=(a("64b4"),Object(X["a"])(Bt,St,qt,!1,null,null,null)),jt=Nt.exports,Ft={name:"Home",data:function(){return{list_new:[],list_hot:[],list_carousel:[]}},components:{RegularNav:Pt,ProductCard:jt},methods:{fileUrl:S,read_new:function(){var t=this;api("product/read",{where:{and:{is_new:!0}}}).then(function(e){return t.list_new=e.data})},read_hot:function(){var t=this;api("product/read",{where:{and:{is_hot:!0}}}).then(function(e){return t.list_hot=e.data})},read_carousel:function(){var t=this;api("product/read",{where:{and:{is_carousel:!0}}}).then(function(e){return t.list_carousel=e.data})}},mounted:function(){this.read_new(),this.read_hot(),this.read_carousel()}},It=Ft,Ut=(a("d9e2"),Object(X["a"])(It,_t,bt,!1,null,"121c3a2c",null)),Mt=Ut.exports,Et=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("RegularNav"),a("div",{staticClass:"container overview"},[a("el-row",{staticClass:"overview",attrs:{gutter:10}},[a("el-col",{staticClass:"preview",attrs:{span:10}},[a("el-carousel",{attrs:{"indicator-position":"outside"}},t._l(t.row.main_img,function(e){return a("el-carousel-item",{key:e.id},[a("img",{staticClass:"main_ing",attrs:{src:t.fileUrl(e),alt:""}})])}),1)],1),a("el-col",{staticClass:"text",attrs:{span:14}},[a("h1",{staticClass:"title"},[t._v(t._s(t.row.title))]),a("div",{staticClass:"well"},[a("dl",{staticClass:"pair"},[a("dt",[t._v("价格")]),a("dd",{staticClass:"hot cny"},[t._v(t._s(t.row.price))])]),a("dl",{staticClass:"pair"},[a("dt",[t._v("运费")]),a("dd",{staticClass:"cny"},[t._v(t._s(t.row.shipping_fee))])])]),a("el-row",[a("el-col",{attrs:{span:8}},[t._v("\n            月销量 "),a("span",{staticClass:"hot"},[t._v("222")])]),a("el-col",{attrs:{span:8}},[t._v("\n            累计评价 "),a("span",{staticClass:"hot"},[t._v("325")])]),a("el-col",{attrs:{span:8}},[t._v("\n            库存 "),a("span",{staticClass:"hot"},[t._v(t._s(t.row.total))])])],1),t._l(t.row.prop,function(e,r){return a("dl",{key:e,staticClass:"pair"},[a("dt",[t._v(t._s(r))]),a("dd",t._l(e,function(e){return a("div",{key:e,class:"pill-option "+(t.form.prop[r]===e?"active":""),on:{click:function(a){return t.setProp(r,e)}}},[t._v(t._s(e))])}),0)])}),a("dl",{staticClass:"pair"},[a("dt",[t._v("数量")]),a("dd",[a("el-input-number",{attrs:{size:"mini",min:1,label:"描述文字"},model:{value:t.form.count,callback:function(e){t.$set(t.form,"count",e)},expression:"form.count"}})],1)]),a("div",{staticClass:"text-left"},[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:t.createOrder}},[t._v("立即购买")]),a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.addToCart}},[t._v("加入购物车")])],1),a("dl",{staticClass:"pair"},[a("dt",[t._v("服务承诺")]),a("dd",[a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("破损包退")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("正品保证")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("极速退款")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("七天无理由退换")]),a("a",{staticClass:"anchor",attrs:{href:"#"}},[t._v("支付方式")])])])],2)],1)],1),a("div",{staticClass:"container detail"},[a("div",{staticClass:"props"},[a("el-row",[a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("生产许可证编号")]),a("div",[t._v("SC12543062605639")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("产品标准号")]),a("div",[t._v("Q/YPXY 0002S")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("厂名")]),a("div",[t._v("平江县新翔宇食品有限公司")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("产品标准号")]),a("div",[t._v("Q/YPXY 0002S")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("生产许可证编号")]),a("div",[t._v("SC12543062605639")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("产品标准号")]),a("div",[t._v("Q/YPXY 0002S")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("厂名")]),a("div",[t._v("平江县新翔宇食品有限公司")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("产品标准号")]),a("div",[t._v("Q/YPXY 0002S")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("生产许可证编号")]),a("div",[t._v("SC12543062605639")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("产品标准号")]),a("div",[t._v("Q/YPXY 0002S")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("厂名")]),a("div",[t._v("平江县新翔宇食品有限公司")])]),a("el-col",{staticClass:"pair",attrs:{span:8}},[a("div",[t._v("产品标准号")]),a("div",[t._v("Q/YPXY 0002S")])])],1)],1),a("div",{staticClass:"content"},t._l(t.row.detail,function(e){return a("div",{key:e},["text"===e.type?a("div",{staticClass:"text"},[t._v(t._s(e.value))]):a("div",{staticClass:"text"},[a("img",{attrs:{src:t.fileUrl(e.value),alt:e.value.name}})])])}),0)])],1)},Dt=[],zt=(a("28a5"),{components:{RegularNav:Pt},name:"Product",data:function(){return{holder:Y,cartService:L,form:{count:1,prop:{}},row:{id:null}}},mounted:function(){this.row.id=this.$route.params.id,this.find()},methods:{fileUrl:S,setProp:function(t,e){this.$set(this.form.prop,t,e)},addToCart:function(){var t=this.row,e=this.form;this.validateForm()&&L.change(t.id,e.count,t,e.prop)},createOrder:function(){var t=this,e=this.row,a=this.form;a.product_id=e.id,a.product_snapshot=e,this.validateForm()&&J([a],C.user("id")).then(function(e){t.$router.push("/my/order/".concat(e.data.id))})},validateForm:function(){if(!C.isAdmin())return this.allPropsChecked()?!!this.form.count||(alert("请选择数量"),!1):(alert("请选择所有属性选项"),!1);alert("管理员暂不可购买商品")},allPropsChecked:function(){var t=this.row.prop;for(var e in t)if(!this.form.prop[e])return!1;return!0},find:function(){var t=this;api("product/find",this.row).then(function(e){t.row=e.data,t.normalize()})},normalize:function(){var t=this.row.prop,e={};for(var a in t){var r=t[a];e[a]=r.split("|")}this.$set(this.row,"prop",e)}}}),At=zt,Vt=(a("1fd9"),Object(X["a"])(At,Et,Dt,!1,null,"72ef49d6",null)),Lt=Vt.exports,Rt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"container"},[r("el-row",{attrs:{gutter:10}},[r("el-col",{attrs:{span:6}},[r("router-link",{attrs:{to:"/"}},[r("div",{staticClass:"logo"},[r("img",{attrs:{src:a("edde"),alt:"Logo"}})])])],1),r("el-col",{staticClass:"text-right",attrs:{span:12}},[r("form",{staticClass:"search",on:{submit:function(e){return e.preventDefault(),t.reload(e)}}},[r("el-input",{attrs:{"suffix-icon":"el-icon-search"},model:{value:t.q.keyword,callback:function(e){t.$set(t.q,"keyword",e)},expression:"q.keyword"}})],1)]),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"logo"})])],1)],1),r("div",{staticClass:"container"},[r("div",{staticClass:"filter"},[r("div",{staticClass:"table"},[r("FilterProp",{attrs:{propName:"分类",initial:t.filterRestore.cat_id,data:t.listCat},on:{change:function(e){return t.setPropFilter("cat_id",e)},clear:function(e){return t.removePropFilter("cat_id")}}}),r("FilterProp",{attrs:{propName:"品牌",initial:t.filterRestore.brand_id,data:t.listBrand},on:{change:function(e){return t.setPropFilter("brand_id",e)},clear:function(e){return t.removePropFilter("brand_id")}}})],1),r("div",{staticClass:"bar"},[r("div",{staticClass:"group"},[r("el-button-group",[r("el-button",{attrs:{type:"id"==t.q.sortBy?"primary":"",size:"mini"},on:{click:function(e){return t.setSortBy("id")}}},[t._v("新品\n              "),"id"==t.q.sortBy?r("span",[1==t.q.sortUp?r("i",{staticClass:"el-icon-caret-top"}):r("i",{staticClass:"el-icon-caret-bottom"})]):t._e()]),r("el-button",{attrs:{type:"price"==t.q.sortBy?"primary":"",size:"mini"},on:{click:function(e){return t.setSortBy("price")}}},[t._v("价格\n              "),"price"==t.q.sortBy?r("span",[1==t.q.sortUp?r("i",{staticClass:"el-icon-caret-top"}):r("i",{staticClass:"el-icon-caret-bottom"})]):t._e()]),r("el-button",{attrs:{type:"sales"==t.q.sortBy?"primary":"",size:"mini"},on:{click:function(e){return t.setSortBy("sales")}}},[t._v("销量\n              "),"sales"==t.q.sortBy?r("span",[1==t.q.sortUp?r("i",{staticClass:"el-icon-caret-top"}):r("i",{staticClass:"el-icon-caret-bottom"})]):t._e()])],1)],1),r("div",{staticClass:"group",attrs:{id:"price-filter"}},[r("el-col",{attrs:{span:12}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.q.minPrice,expression:"q.minPrice"}],attrs:{size:"mini",placeholder:"最底价格"},domProps:{value:t.q.minPrice},on:{keyup:t.reload,input:function(e){e.target.composing||t.$set(t.q,"minPrice",e.target.value)}}})]),r("el-col",{attrs:{span:12}},[r("input",{directives:[{name:"model",rawName:"v-model",value:t.q.maxPrice,expression:"q.maxPrice"}],attrs:{size:"mini",placeholder:"最高价格"},domProps:{value:t.q.maxPrice},on:{keyup:t.reload,input:function(e){e.target.composing||t.$set(t.q,"maxPrice",e.target.value)}}})])],1),r("div",{staticClass:"group"},[r("label",[r("input",{attrs:{type:"checkbox"},domProps:{checked:t.q.freeShipping},on:{click:function(e){return t.toggleBool("freeShipping")}}}),t._v("\n            包邮\n          ")]),r("label",[r("input",{attrs:{type:"checkbox"},domProps:{checked:t.q.hasDiscount},on:{click:function(e){return t.toggleBool("hasDiscount")}}}),t._v("\n            折扣\n          ")]),r("label",[r("input",{attrs:{type:"checkbox"},domProps:{checked:t.q.cod},on:{click:function(e){return t.toggleBool("cod")}}}),t._v("\n            货到付款\n          ")])])])])]),r("div",{staticClass:"container"},[r("div",{staticClass:"result"},[r("el-row",{staticClass:"card-list vertical-gutter",attrs:{gutter:5}},t._l(t.list,function(t){return r("el-col",{key:t,attrs:{span:6}},[r("ProductCard",{attrs:{data:t}})],1)}),1),0!=t.total?r("el-pagination",{staticClass:"text-center",attrs:{total:t.total,layout:"prev, pager, next","page-count":t.q.limit,"current-page":t.q.page},on:{"current-change":t.flip}}):t._e()],1)])])},Tt=[],Yt=a("bd86"),Gt=(a("f559"),a("386d"),a("e814")),Qt=a.n(Gt),Xt=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-row",[a("el-col",{staticClass:"type",attrs:{span:3}},[t._v(t._s(t.propName))]),a("el-col",{attrs:{span:21}},t._l(t.data,function(e){return a("div",{key:e,class:"option "+(t.selected&&t.selected.id==e.id?"active":""),on:{click:function(a){return t.select(e)}}},[t._v("\n      "+t._s(e.name)+"\n    ")])}),0)],1)},Kt=[],Wt={props:["data","propName","initial"],data:function(){return{selected:null}},mounted:function(){this.initial&&(this.selected=this.initial)},methods:{select:function(t){if(this.selected&&this.selected.id==t.id)return this.selected=null,void this.$emit("clear",t);this.selected=t,this.$emit("change",t)}},watch:{initial:function(t){this.select(t)}}},Jt=Wt,Zt=(a("14d4"),Object(X["a"])(Jt,Xt,Kt,!1,null,"72beae5c",null)),Ht=Zt.exports,te={components:{FilterProp:Ht,ProductCard:jt,RegularNav:Pt},data:function(){return{list:[],total:0,listCat:[],listBrand:[],filterRestore:{},q:{page:1,limit:16,sortBy:"id"}}},mounted:function(){this.q=Object(P["a"])({},this.q,this.$route.query,{page:Qt()(this.$route.query.page)}),this.read("cat"),this.read("brand"),this.search(),this.restoreSelectedPropFilter("brand",this.q["@brand_id"],"brand_id"),this.restoreSelectedPropFilter("cat",this.q["@cat_id"],"cat_id")},methods:{restoreSelectedPropFilter:function(t,e,a){var r=this;e&&api("".concat(t,"/find"),{id:e}).then(function(t){r.$set(r.filterRestore,a,t.data)})},setPropFilter:function(t,e){this.q["@"+t]=e.id,this.reload()},removePropFilter:function(t){delete this.q["@"+t],this.reload()},read:function(t){var e=this;api("".concat(t,"/read")).then(function(a){return e["list"+B(t)]=a.data})},toggleBool:function(t){this.q[t]?delete this.q[t]:this.q[t]="1",this.reload()},setSortBy:function(t){this.q.sortBy==t&&(this.q.sortUp?delete this.q.sortUp:this.q.sortUp="1"),this.q.sortBy=t,this.reload()},reload:function(){this.$router.push({path:"/search",query:Object(P["a"])({},this.q)})},forEachPropFilter:function(t){var e=this.q;for(var a in e)a.startsWith("@")&&t(e[a],a)},flip:function(t){this.q.page=t,this.reload()},search:function(){var t=this,e=this.q,a='"title" contains "'.concat(e.keyword,'"'),r=e.minPrice?'and "price" >= '.concat(e.minPrice):"",n=e.maxPrice?'and "price" <= '.concat(e.maxPrice):"",s=e.freeShipping?'and "shipping_fee" = 0':"",i=e.hasDiscount?'and "discount" > 0':"",o=e.cod?'and "cod" = 1':"",l="";this.forEachPropFilter(function(t,e){var a=e.slice(1);l+=' and "'.concat(a,'" = "').concat(t,'" ')});var c="where(\n        ".concat(a,"\n        ").concat(r,"\n        ").concat(n,"\n        ").concat(s,"\n        ").concat(i,"\n        ").concat(o,"\n        ").concat(l,"\n      )"),u=Object(Yt["a"])({query:c,sort_by:[e.sortBy||"id",e.sortUp?"up":"down"],limit:this.limit,page:e.page},"limit",e.limit);api("product/read",u).then(function(e){t.list=e.data,t.total=e.total})}},watch:{$route:{deep:!0,handler:function(t,e){this.q=Object(P["a"])({},this.q,t.query,{page:Qt()(t.query.page)}),this.search()}}}},ee=te,ae=(a("609f"),Object(X["a"])(ee,Rt,Tt,!1,null,"2b6a7144",null)),re=ae.exports,ne=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"form-container"},[a("h1",[t._v("登录")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.login(e)}}},[a("label",[t._v("\n        手机号/邮箱\n        "),a("el-input",{model:{value:t.form.uiqueName,callback:function(e){t.$set(t.form,"uiqueName",e)},expression:"form.uiqueName"}})],1),a("label",[t._v("\n        密码\n        "),a("el-input",{attrs:{type:"text"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("div",{staticClass:"errors"},t._l(t.errors,function(e){return a("div",{key:e},[t._v(t._s(e))])}),0),a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("立即创建")]),a("el-button",{attrs:{type:"text"}},[a("router-link",{attrs:{to:"/recover"}},[t._v("忘记密码？")])],1)],1)])])])},se=[],ie={name:"Login",data:function(){return{form:{uiqueName:"",password:""},errors:[]}},methods:{login:function(){if(this.validate()){var t=this.errors,e=this.form;"admin"!==e.uiqueName||"yoyoyo"!==e.password?api("user/first",{where:{or:[["mail","=",e.uiqueName],["phone","=",e.uiqueName]]}}).then(function(a){var r=a.data;r&&r.password===e.password?(delete r.password,C.login(r.id,r)):t.push("手机号/邮箱或密码输入有误")}):C.login("admin",{nickname:"Admin",IS_ADMIN:!0})}},validate:function(){var t=!0,e=this.form,a=this.errors=[];return e.uiqueName&&e.password||(a.push("手机号/邮箱或密码不能为空"),t=!1),t}},components:{}},oe=ie,le=Object(X["a"])(oe,ne,se,!1,null,null,null),ce=le.exports,ue=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"form-container"},[a("h1",[t._v("注册")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.signup(e)}}},[a("el-tabs",{model:{value:t.signupBy,callback:function(e){t.signupBy=e},expression:"signupBy"}},[a("el-tab-pane",{attrs:{label:"手机注册",name:"phone"}},[a("label",[a("span",{staticClass:"title"},[t._v("手机号")]),a("el-input",{on:{blur:t.uniqueExist},model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)]),a("el-tab-pane",{attrs:{label:"邮箱注册",name:"mail"}},[a("label",[a("span",{staticClass:"title"},[t._v("邮箱")]),a("el-input",{on:{blur:t.uniqueExist},model:{value:t.form.mail,callback:function(e){t.$set(t.form,"mail",e)},expression:"form.mail"}})],1)])],1),a("label",[a("fieldset",{attrs:{disabled:!t.unique}},[a("span",{staticClass:"title"},[t._v("验证码")]),a("el-row",[a("el-col",{attrs:{span:18}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),a("el-col",{attrs:{span:6}},[a("Captcha",{attrs:{sendBy:t.signupBy,receiver:t.form[t.signupBy],className:"el-button el-button--default"},on:{send:t.onCaptchaSend}})],1)],1)],1)]),a("label",[a("span",{staticClass:"title"},[t._v("密码")]),a("el-input",{attrs:{type:"text"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1),a("div",{staticClass:"error"},t._l(t.errors,function(e){return a("div",{key:e},[t._v(t._s(e))])}),0),a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("加入吃货团")]),a("el-button",{attrs:{type:"text"}},[a("router-link",{attrs:{to:"/login"}},[t._v("已有账号？登录")])],1)],1)],1)])])},pe=[],de=(a("3b2b"),a("6762"),a("2fdb"),a("aef6"),a("59ad")),me=a.n(de),fe={required:function(t){return!(!t&&0!==t)},numeric:function(t){return!!/^\d+$/.test(t.toString())},min:function(t,e){return!(me()(t)<e)},max:function(t,e){return!(me()(t)>e)},between:function(t,e,a){return!(!this.min(t,e)||!this.max(t,a))},positive:function(t){return!!this.numeric(t)&&!(t<=0)},negative:function(t){return!!this.numeric(t)&&!(t>=0)},minLength:function(t,e){return!(t.length<e)},maxLength:function(t,e){return!(t.length>e)},lengthBetween:function(t,e,a){return!(!this.minLength(t,e)||!this.maxLength(t,a))},startsWith:function(t,e){return!!t.startsWith(e)},endsWith:function(t,e){return!!t.endsWith(e)},includes:function(t,e){return!!t.includes(e)},in:function(t,e){return-1!==e.indexOf(t)},mail:function(t){var e=/^\w+@\w+\.\w+$/;return!!e.test(t)},username:function(t){var e=/^[a-zA-Z0-9]\w+$/;return!!e.test(t)},phone:function(t){var e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"zh";switch(a){case"zh":e=/^(?:\+?(?:86))?(\s|-)?1\d{10}$/;break}return!!e.test(t)},regex:function(t,e){return"string"==typeof e&&(e=new RegExp(e)),!!e.test(t)},unique:function(t,e,a,r){return M("".concat(e,"/").concat(a),{where:{and:Object(Yt["a"])({},r,t)}}).then(function(t){return!t.data})}};function ve(t,e){if("required"!==t&&!e&&0!==e)return!0;for(var a=arguments.length,r=new Array(a>2?a-2:0),n=2;n<a;n++)r[n-2]=arguments[n];return fe[t].apply(fe,[e].concat(r))}var he=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("button",{class:t.className,attrs:{type:"button",disabled:0!==t.count},on:{click:function(e){return t.send()}}},[t.count?a("span",[t._v(t._s(t.count)+"s")]):a("span",[t._v("发送验证码")])])])},_e=[];function be(t,e,a){var r;return r="phone"==t?"sms":"mail",api("captcha/".concat(r),Object(Yt["a"])({},t,e)).then(function(t){var e=atob(t.data.result);return a&&a(e),e})}var ge={props:["sendBy","receiver","className","countDown"],data:function(){return{timer:null,count:0}},methods:{send:function(){var t=this;this.count||(this.count=this.countDown||10,this.timer=setInterval(function(){t.count--,0==t.count&&clearInterval(t.timer)},1e3),be(this.sendBy,this.receiver).then(function(e){t.$emit("send",e)}))}}},ye=ge,Ce=Object(X["a"])(ye,he,_e,!1,null,null,null),we=Ce.exports,ke={components:{Captcha:we},data:function(){return{signupBy:"phone",form:{phone:"",mail:"",password:"",code:""},errors:[],code:null,unique:!1}},methods:{signup:function(){var t=this;if(this.validate()){var e=this.form;api("user/create",e).then(function(e){t.$router.push("/login")})}},validate:function(){var t=this.form,e=this.errors=[],a=this.signupBy;return this.form[this.signupBy]||e.push("邮箱或手机为必填项"),"phone"!=a||fe.phone(t.phone)||e.push("手机格式有误"),"mail"!=a||fe.mail(t.mail)||e.push("邮箱格式有误"),t.password.length<6&&e.push("密码长度不可小于6"),t.code!=this.code&&e.push("验证码有误"),!e.length},uniqueExist:function(){var t=this,e=this.signupBy,a=this.form[this.signupBy];a&&api("user/first",{where:{and:Object(Yt["a"])({},e,a)}}).then(function(e){if(e.data)return t.errors.push("账号已存在"),void(t.unique=!1);t.unique=!0})},onCaptchaSend:function(t){this.code=t}}},xe=ke,$e=Object(X["a"])(xe,ue,pe,!1,null,null,null),Pe=$e.exports,Se=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"form-container"},[a("h1",[t._v("账号恢复")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.nextStep(e)}}},[1==t.step?a("div",[a("el-tabs",{model:{value:t.recoverBy,callback:function(e){t.recoverBy=e},expression:"recoverBy"}},[a("el-tab-pane",{attrs:{label:"通过手机恢复",name:"phone"}},[a("label",[a("span",{staticClass:"title"},[t._v("手机号")]),a("el-input",{model:{value:t.form.phone,callback:function(e){t.$set(t.form,"phone",e)},expression:"form.phone"}})],1)]),a("el-tab-pane",{attrs:{label:"通过邮箱恢复",name:"mail"}},[a("label",[a("span",{staticClass:"title"},[t._v("邮箱")]),a("el-input",{model:{value:t.form.mail,callback:function(e){t.$set(t.form,"mail",e)},expression:"form.mail"}})],1)])],1)],1):t._e(),2==t.step?a("div",[a("label",[a("el-row",[a("el-col",{attrs:{span:18}},[a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:t.form.code,callback:function(e){t.$set(t.form,"code",e)},expression:"form.code"}})],1),a("el-col",{attrs:{span:6}},[a("Captcha",{attrs:{sendBy:t.recoverBy,className:"el-button el-button--default",receiver:t.form[t.recoverBy]},on:{send:t.onCaptchaSend}})],1)],1)],1)]):t._e(),3==t.step?a("div",[a("label",{attrs:{label:"密码"}},[a("el-input",{attrs:{type:"text",placeholder:"请输入新密码"},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)]):t._e(),a("div",{staticClass:"error"},t._l(t.errors,function(e){return a("div",{key:e},[t._v(t._s(e))])}),0),t._m(0)])])])},qe=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("下一步")])])}],Oe={components:{Captcha:we},data:function(){return{recoverBy:"phone",form:{phone:"",mail:"",password:"",code:""},sendCodeCountDown:0,errors:[],code:null,codeTimer:null,step:1,user:null}},methods:{validate:function(){var t=this.form,e=this.errors=[],a=this.recoverBy;return this.form[this.recoverBy]||e.push("邮箱或手机为必填项"),"phone"!=a||fe.phone(t.phone)||e.push("手机格式有误"),"mail"!=a||fe.mail(t.mail)||e.push("邮箱格式有误"),t.password.length<6&&e.push("密码长度不可小于6"),t.code!=this.code&&e.push("验证码有误"),!e.length},onCaptchaSend:function(t){this.code=t},nextStep:function(){var t=this,e=this.form,a=this.recoverBy;switch(this.errors=[],this.step){case 1:if(!e[a])return void this.errors.push("请输入账号");api("user/first",{where:{and:Object(Yt["a"])({},a,e[a])}}).then(function(e){var a=e.data;a?(console.log(a),t.user=a,t.step++):t.errors.push("账号不存在")});break;case 2:this.code!==e.code?this.errors.push("验证码有误"):this.step++;break;case 3:var r=Object(Yt["a"])({id:this.user.id,password:e.password},a,e[a]);api("user/update",r).then(function(e){t.$router.push("/login")});break}}}},Be=Oe,Ne=Object(X["a"])(Be,Se,qe,!1,null,null,null),je=Ne.exports,Fe=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:4}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"cart",router:!0},on:{open:t.handleOpen,close:t.handleClose}},[a("el-menu-item",{staticClass:"side-focus",attrs:{index:"cart"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("购物车")])]),a("el-menu-item",{staticClass:"side-focus",attrs:{index:"order"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("订单")])]),a("el-menu-item",{staticClass:"side-focus",attrs:{index:"settings"}},[a("span",{attrs:{slot:"title"},slot:"title"},[t._v("设置")])])],1)],1),a("el-col",{attrs:{span:20}},[a("router-view")],1)],1)],1)},Ie=[],Ue={name:"My",components:{},methods:{handleOpen:function(){},handleClose:function(){}}},Me=Ue,Ee=(a("3d0d"),Object(X["a"])(Me,Fe,Ie,!1,null,null,null)),De=Ee.exports,ze=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("设置")]),a("div",{staticClass:"toolbar"},[a("button",{on:{click:function(e){t.editMode=!t.editMode}}},[t.editMode?a("span",[t._v("取消")]):a("span",[t._v("编辑")])])]),a("form",{on:{submit:function(e){return e.preventDefault(),t.update(e)}}},[a("fieldset",{attrs:{disabled:t.updatePending}},[a("dl",{staticClass:"pair"},[a("dt",[t._v("昵称")]),a("dd",[t.editMode?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.me.nickname,expression:"me.nickname"}],staticClass:"field",attrs:{type:"text",readonly:!t.editMode},domProps:{value:t.me.nickname},on:{input:function(e){e.target.composing||t.$set(t.me,"nickname",e.target.value)}}})]):a("span",[a("span",[t._v(t._s(t.me.nickname||"-"))])])])]),a("dl",{staticClass:"pair"},[a("dt",[t._v("手机号")]),a("dd",[t.editMode?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.me.phone,expression:"me.phone"}],staticClass:"field",attrs:{type:"text",readonly:!t.editMode},domProps:{value:t.me.phone},on:{input:function(e){e.target.composing||t.$set(t.me,"phone",e.target.value)}}}),t.me.phone!=t.meCopy.phone&&t.validMe?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tmp.captchaInput,expression:"tmp.captchaInput"}],attrs:{type:"text"},domProps:{value:t.tmp.captchaInput},on:{input:function(e){e.target.composing||t.$set(t.tmp,"captchaInput",e.target.value)}}}),a("Captcha",{attrs:{"send-by":"phone",receiver:t.me.phone},on:{send:t.storeCaptcha}})],1):t._e()]):a("span",[a("span",[t._v(t._s(t.me.phone||"-"))])])])]),a("dl",{staticClass:"pair"},[a("dt",[t._v("邮箱")]),a("dd",[t.editMode?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.me.mail,expression:"me.mail"}],staticClass:"field",attrs:{type:"text",readonly:!t.editMode},domProps:{value:t.me.mail},on:{input:function(e){e.target.composing||t.$set(t.me,"mail",e.target.value)}}}),t.me.mail!=t.meCopy.mail&&t.validMe?a("span",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.tmp.captchaInput,expression:"tmp.captchaInput"}],attrs:{type:"text"},domProps:{value:t.tmp.captchaInput},on:{input:function(e){e.target.composing||t.$set(t.tmp,"captchaInput",e.target.value)}}}),a("Captcha",{attrs:{"send-by":"mail",receiver:t.me.mail},on:{send:t.storeCaptcha}})],1):t._e()]):a("span",[a("span",[t._v(t._s(t.me.mail||"-"))])])])]),a("div",{staticClass:"error-list"},[t._l(t.errorMsg,function(e){return a("div",{key:e,staticClass:"error"},[t._v(t._s(e))])}),t.invalidCaptcha?a("div",{staticClass:"error"},[t._v("验证码有误")]):t._e()],2),t.editMode?a("div",[a("button",{staticClass:"el-button--primary",attrs:{type:"submit"}},[t._v("完成")])]):t._e()])])])},Ae=[],Ve={components:{Captcha:we},data:function(){return{invalidCaptcha:!1,tmp:{},me:{},meCopy:{},editMode:!1,updatePending:!1,errorMsg:[]}},computed:{validMe:function(){return!this.errorMsg.length}},mounted:function(){this.findMe()},methods:{validate:function(){this.errorMsg=[];var t=this.me;return fe.phone(t.phone)||this.errorMsg.push("手机号不合法"),fe.mail(t.mail)||this.errorMsg.push("邮箱不合法"),this.changed("phone")&&(this.verifyCaptcha()||(this.invalidCaptcha=!0)),this.changed("mail")&&(this.verifyCaptcha()||(this.invalidCaptcha=!0)),!this.errorMsg.length&&!this.invalidCaptcha},findMe:function(){var t=this;api("user/find",{id:C.user("id")}).then(function(e){t.me=e.data,t.copyMe()})},copyMe:function(){this.meCopy=Object(P["a"])({},this.me)},storeCaptcha:function(t){this.tmp.captchaAnswer=t},verifyCaptcha:function(){return this.tmp.captchaAnswer==this.tmp.captchaInput},changed:function(t){return this.me[t]!==this.meCopy[t]},update:function(){var t=this;this.validate()&&(this.updatePending=!0,api("user/update",this.me).then(function(e){var a=t.me=e.data;t.editMode=!1,t.updatePending=!1,t.copyMe(),C.login(a.id,a,function(t){location.reload()})}))}},watch:{me:{deep:!0,handler:function(){this.editMode&&this.validate()}}}},Le=Ve,Re=Object(X["a"])(Le,ze,Ae,!1,null,null,null),Te=Re.exports,Ye=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("我的订单")]),t.$route.params.id?a("el-card",{staticClass:"detail"},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[t._v("订单详情")]),a("router-link",{staticStyle:{float:"right"},attrs:{to:"/my/order"}},[t._v("关闭")])],1),a("div",{staticClass:"card-content"},[a("div",{staticClass:"pair"},[a("div",[t._v("订单号")]),a("div",[t._v(t._s(t.form.id))])]),a("div",{staticClass:"pair"},[a("div",[t._v("总价")]),a("div",{staticClass:"cny"},[t._v(t._s(t.form.sum))])]),a("div",{staticClass:"pair"},[a("div",[t._v("付款方式")]),a("div",[t._v(t._s(t.lang.payment[t.form._pay_by]||"-"))])]),a("div",{staticClass:"pair"},[a("div",[t._v("订单状态")]),a("div",[t._v(t._s(t.form._paid?"已支付":"未支付"))])]),t.form._paid?t._e():a("div",{staticStyle:{"margin-top":"1em"}},[a("div",{staticClass:"title"},[t._v("请选择支付方式")]),a("p",[t._v("测试支付价格不会超过0.2元")]),a("el-button",{on:{click:function(e){return t.generatePaymentUrl("wechat")}}},[t._v("微信支付")]),a("el-button",{on:{click:function(e){return t.generatePaymentUrl("alipay")}}},[t._v("支付宝")]),t.form.$payment?a("div",["wechat"===t.form._pay_by?a("p",[a("img",{staticClass:"qrcode",attrs:{src:t.form.$payment.qrcode,alt:"支付二维码"}}),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.read(),t.find()}}},[t._v("支付完毕")])],1):a("p",[a("a",{attrs:{href:t.form.$payment.url}},[t._v("跳转支付宝扫码支付")])])]):t._e()],1)])]):t._e(),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"订单号",width:"100"}}),a("el-table-column",{attrs:{prop:"sum",label:"总价",width:"50"}}),a("el-table-column",{attrs:{label:"状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row._paid?"已支付":"未支付")+"\n      ")]}}])}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"}},[a("router-link",{attrs:{to:"/my/order/"+e.row.id}},[t._v("详情")])],1)]}}])})],1)],1)},Ge=[],Qe={data:function(){return{form:{},list:[],params:{},lang:{payment:{alipay:"支付宝",wechat:"微信支付"},status:{created:"未支付",paid:"已支付"}}}},mounted:function(){this.read(),this.form.id=this.$route.params.id,this.form.id&&this.find()},methods:{find:function(){var t=this;api("order/find",{id:this.form.id}).then(function(e){return t.form=e.data})},read:function(){var t=this;api("order/read",{where:{and:{user_id:C.user("id")}}}).then(function(e){return t.list=e.data})},generatePaymentUrl:function(t){var e=this;this.form._pay_by=t,api("order/payment/url",{id:this.form.id,pay_by:t,fee:.2,return_url:q("#/my/order")}).then(function(t){e.$set(e.form,"$payment",t.data)})}},watch:{$route:{handler:function(t,e){var a=t.params;a.id&&(this.form.id=a.id,this.find())},deep:!0}}},Xe=Qe,Ke=(a("9261"),Object(X["a"])(Xe,Ye,Ge,!1,null,"1e2e56e2",null)),We=Ke.exports,Je=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{span:4}},[a("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"cart",router:!0},on:{open:t.handleOpen,close:t.handleClose}},[a("el-menu-item",{attrs:{index:"order"}},[a("router-link",{attrs:{slot:"title",to:"/admin/order"},slot:"title"},[t._v("订单管理")])],1),a("el-menu-item",{attrs:{index:"user"}},[a("router-link",{attrs:{slot:"title",to:"/admin/user"},slot:"title"},[t._v("用户管理")])],1),a("el-menu-item",{attrs:{index:"brand"}},[a("router-link",{attrs:{slot:"title",to:"/admin/brand"},slot:"title"},[t._v("品牌管理")])],1),a("el-menu-item",{attrs:{index:"cat"}},[a("router-link",{attrs:{slot:"title",to:"/admin/cat"},slot:"title"},[t._v("分类管理")])],1),a("el-menu-item",{attrs:{index:"product"}},[a("router-link",{attrs:{slot:"title",to:"/admin/product"},slot:"title"},[t._v("商品管理")])],1)],1)],1),a("el-col",{attrs:{span:18}},[a("router-view")],1)],1)],1)},Ze=[],He=(a("814f"),{methods:{handleOpen:function(){},handleClose:function(){}}}),ta=He,ea=Object(X["a"])(ta,Je,Ze,!1,null,null,null),aa=ea.exports,ra=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("用户管理")]),a("div",[a("el-button-group",[a("el-button",{on:{click:function(e){t.ui.formVisible=!t.ui.formVisible}}},[t.ui.formVisible?a("span",[t._v("取消")]):a("span",[t._v("创建")])])],1)],1),t.ui.formVisible?a("div",[a("h2",[t._v("添加/修改")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[a("label",[a("span",{staticClass:"title"},[t._v("昵称")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.nickname,expression:"form.nickname"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.form.nickname},on:{input:function(e){e.target.composing||t.$set(t.form,"nickname",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.nickname,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.nickname[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("电话")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.phone,expression:"form.phone"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.form.phone},on:{input:function(e){e.target.composing||t.$set(t.form,"phone",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.phone,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.phone[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("邮箱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.mail,expression:"form.mail"}],staticClass:"el-input__inner",attrs:{type:"email"},domProps:{value:t.form.mail},on:{input:function(e){e.target.composing||t.$set(t.form,"mail",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.mail,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.mail[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("密码")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.password,expression:"form.password"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.form.password},on:{input:function(e){e.target.composing||t.$set(t.form,"password",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.password,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.password[r].msg))]):t._e()}),0)]),a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("提交")]),a("button",{staticClass:"el-button el-button--text",on:{click:function(e){t.ui.formVisible=!1}}},[t._v("取消")])])])]):t._e(),a("div",[a("h2",[t._v("列表")]),a("p",[t._v("总数："+t._s(t.total))]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"nickname",label:"昵称",width:"1800"}}),a("el-table-column",{attrs:{prop:"phone",label:"手机号",width:"180"}}),a("el-table-column",{attrs:{prop:"mail",label:"邮箱"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.fill(e.row)}}},[t._v("更新")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.remove(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"text-center"},[a("el-pagination",{attrs:{"page-size":t.readParam.limit,"current-page":t.readParam.page,layout:"prev, pager, next",total:t.total},on:{"current-change":t.flip}})],1)],1)])},na=[],sa=a("75fc"),ia={mounted:function(){this.read()},data:function(){return{ui:{formVisible:!1},readParam:{limit:10,page:1},list:[],form:{},total:0,formOriginal:null,rules:{},errors:{}}},methods:{flip:function(t){this.readParam.page=t,this.read()},validate:function(t){var e=this,a=this.form[t],r=!0,n=this.rules[t],s=function(s){var i=n[s],o=i.params||[],l=ve.apply(void 0,[s,a].concat(Object(sa["a"])(o)));"boolean"==typeof l?(e.afterValidate(t,s,l),l||(r=!1)):l.then(function(a){e.afterValidate(t,s,a)})};for(var i in n)s(i);return r},validateForm:function(){var t=this.rules,e=!0,a=this.form,r=!!a.id;for(var n in t)r&&a[n]===this.formOriginal[n]||this.validate(n)||(e=!1);return e},afterValidate:function(t,e,a){var r=this.errors[t];r||(r=this.$set(this.errors,t,{})),this.$set(r,e,!a)},fill:function(t){console.log(t),this.ui.formVisible=!0,this.formOriginal=t,this.form=Object(P["a"])({},t)},remove:function(t){var e=this;confirm("确定要删除此项吗？")&&api("".concat(this.model,"/delete"),{id:t}).then(function(t){e.read()})},read:function(){var t=this;api("".concat(this.model,"/read"),this.readParam).then(function(e){t.list=e.data,t.total=e.total})},createOrUpdate:function(){var t=this;if(this.validateForm()){var e,a=this.form;e=a.id?"update":"create",api("".concat(this.model,"/").concat(e),a).then(function(e){t.resetForm(),t.read()})}},resetForm:function(){this.ui.formVisible=!1,this.form={}},makeSelect:function(t){var e=this;return function(a){e.form[t]=a.id}}}},oa={mixins:[ia],data:function(){return{model:"user",rules:{mail:{unique:{params:["user","exists","mail"],msg:"邮箱已存在"},mail:{msg:"邮箱格式有误"}},phone:{required:{msg:"手机号为必填项"},unique:{params:["user","exists","phone"],msg:"手机号已存在"},phone:{msg:"手机号格式有误"}},password:{required:{msg:"密码为必填项"},lengthBetween:{params:[6,24],msg:"密码长度需在6位24位之间"},regex:{params:[/(?=[^0-9]*[0-9]+)(?=[^a-zA-Z]*[a-zA-Z]+)/],msg:"密码必须包含字母和数字"}},nickname:{lengthBetween:{params:[2,24],msg:"昵称长度需在2至24位之间"}}}}},methods:{}},la=oa,ca=Object(X["a"])(la,ra,na,!1,null,null,null),ua=ca.exports,pa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("订单管理")]),a("div",[a("h2",[t._v("列表")]),a("p",[t._v("总数："+t._s(t.total))]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"id",label:"订单号",width:"180"}}),a("el-table-column",{attrs:{label:"状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n          "+t._s(e.row._paid?"已支付":"未支付")+"\n        ")]}}])}),a("el-table-column",{attrs:{prop:"sum",label:"总费用",width:"180"}}),a("el-table-column",{attrs:{prop:"detail.length",label:"产品数",width:"180"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.fill(e.row)}}},[t._v("更新")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.remove(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"text-center"},[a("el-pagination",{attrs:{"page-size":t.readParam.limit,"current-page":t.readParam.page,layout:"prev, pager, next",total:t.total},on:{"current-change":t.flip}})],1)],1)])},da=[],ma={mixins:[ia],data:function(){return{model:"order"}},methods:{}},fa=ma,va=Object(X["a"])(fa,pa,da,!1,null,null,null),ha=va.exports,_a=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("分类管理")]),a("div",[a("el-button-group",[a("el-button",{on:{click:function(e){t.ui.formVisible=!t.ui.formVisible}}},[t.ui.formVisible?a("span",[t._v("取消")]):a("span",[t._v("创建")])])],1)],1),t.ui.formVisible?a("div",[a("h2",[t._v("添加/修改")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[a("label",[a("span",{staticClass:"title"},[t._v("分类名")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.name,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.name[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("父级分类")]),a("Dropdown",{attrs:{api:"cat/read",searchBy:"name",displayBy:"name",className:"el-input__inner",onSelect:t.makeSelect("parent_id")}}),a("span",{staticClass:"error-list"},t._l(t.errors.parent_id,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.parent_id[r].msg))]):t._e()}),0)],1),a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("提交")]),a("button",{staticClass:"el-button el-button--text",on:{click:function(e){t.ui.formVisible=!1}}},[t._v("取消")])])])]):t._e(),a("div",[a("h2",[t._v("列表")]),a("p",[t._v("总数："+t._s(t.total))]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"分类名",width:"180"}}),a("el-table-column",{attrs:{prop:"$parent.name",label:"父级分类",width:"180"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.fill(e.row)}}},[t._v("更新")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.remove(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"text-center"},[a("el-pagination",{attrs:{"page-size":t.readParam.limit,"current-page":t.readParam.page,layout:"prev, pager, next",total:t.total},on:{"current-change":t.flip}})],1)],1)])},ba=[],ga=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"dropdown"},[a("div",{staticClass:"filter"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.keyword,expression:"keyword"}],class:t.className,attrs:{type:"search"},domProps:{value:t.keyword},on:{focus:function(e){t.visible=!0,t.reset()},blur:function(e){t.hideResult(),t.$emit("blur")},input:function(e){e.target.composing||(t.keyword=e.target.value)}}})]),t.visible?a("div",{staticClass:"list"},t._l(t.result,function(e){return a("div",{key:e,staticClass:"option",on:{mousedown:function(a){return t.select(e)}}},[t._v(t._s(e[t.displayBy]))])}),0):t._e()])])},ya=[],Ca={props:["list","searchBy","displayBy","onSelect","api","className"],data:function(){return{visible:!1,keyword:"",result:[],timer:null}},mounted:function(){this.api?this.filterAsync():this.result=Object(sa["a"])(this.list)},methods:{hideResult:function(){var t=this;setTimeout(function(){t.visible=!1},1)},reset:function(){this.keyword="",this.select(null)},select:function(t){t&&(this.keyword=t[this.displayBy]),t&&this.onSelect&&this.onSelect(t)},filter:function(){var t=this;this.result=this.list.filter(function(e){return e[t.searchBy].includes(t.keyword)})},filterAsync:function(){var t=this,e={};this.keyword&&(e={query:'where("'.concat(this.searchBy,'" contains "').concat(this.keyword,'")')}),M(this.api,e).then(function(e){return t.result=e.data||[]})},debounceFilterAsync:function(){var t=this;this.timer&&clearTimeout(this.timer),this.timer=setTimeout(function(){t.filterAsync()},300)}},watch:{keyword:function(t,e){this.api?this.debounceFilterAsync():this.filter()}}},wa=Ca,ka=(a("1fef"),Object(X["a"])(wa,ga,ya,!1,null,"6ff118cf",null)),xa=ka.exports,$a={components:{Dropdown:xa},mixins:[ia],data:function(){return{model:"cat",readParam:{with:[{model:"cat",relation:"belongs_to",foreign_key:"parent_id",as:"parent"}]},rules:{name:{required:{msg:"分类为必填项"}}}}},methods:{}},Pa=$a,Sa=Object(X["a"])(Pa,_a,ba,!1,null,"f37725e6",null),qa=Sa.exports,Oa=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("品牌管理")]),a("div",[a("el-button-group",[a("el-button",{on:{click:function(e){t.ui.formVisible=!t.ui.formVisible}}},[t.ui.formVisible?a("span",[t._v("取消")]):a("span",[t._v("创建")])])],1)],1),t.ui.formVisible?a("div",[a("h2",[t._v("添加/修改")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[a("label",[a("span",{staticClass:"title"},[t._v("品牌名")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.name,expression:"form.name"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.form.name},on:{input:function(e){e.target.composing||t.$set(t.form,"name",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.name,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.name[r].msg))]):t._e()}),0)]),a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("提交")]),a("button",{staticClass:"el-button el-button--text",on:{click:function(e){t.ui.formVisible=!1}}},[t._v("取消")])])])]):t._e(),a("div",[a("h2",[t._v("列表")]),a("p",[t._v("总数："+t._s(t.total))]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"name",label:"品牌名",width:"180"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.fill(e.row)}}},[t._v("更新")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.remove(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"text-center"},[a("el-pagination",{attrs:{"page-size":t.readParam.limit,"current-page":t.readParam.page,layout:"prev, pager, next",total:t.total},on:{"current-change":t.flip}})],1)],1)])},Ba=[],Na={mixins:[ia],data:function(){return{model:"brand",rules:{name:{required:{msg:"品牌名为必填项"}}}}},methods:{}},ja=Na,Fa=Object(X["a"])(ja,Oa,Ba,!1,null,null,null),Ia=Fa.exports,Ua=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("h1",[t._v("商品管理")]),a("div",[a("el-button-group",[a("el-button",{on:{click:function(e){t.ui.formVisible=!t.ui.formVisible}}},[t.ui.formVisible?a("span",[t._v("取消")]):a("span",[t._v("创建")])])],1)],1),t.ui.formVisible?a("div",[a("h2",[t._v("添加/修改")]),a("form",{on:{submit:function(e){return e.preventDefault(),t.createOrUpdate(e)}}},[a("label",[a("span",{staticClass:"title"},[t._v("标题")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.title,expression:"form.title"}],staticClass:"el-input__inner",attrs:{type:"text"},domProps:{value:t.form.title},on:{input:function(e){e.target.composing||t.$set(t.form,"title",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.title,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.title[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("分类")]),a("Dropdown",{attrs:{api:"cat/read",searchBy:"name",displayBy:"name",select:"form.cat_id",className:"el-input__inner",onSelect:t.makeSelect("cat_id")}}),a("span",{staticClass:"error-list"},t._l(t.errors.cat_id,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.cat_id[r].msg))]):t._e()}),0)],1),a("label",[a("span",{staticClass:"title"},[t._v("品牌")]),a("Dropdown",{attrs:{api:"brand/read",searchBy:"name",displayBy:"name",select:"form.brand_id",className:"el-input__inner",onSelect:t.makeSelect("brand_id")}}),a("span",{staticClass:"error-list"},t._l(t.errors.brand_id,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.brand_id[r].msg))]):t._e()}),0)],1),a("label",[a("span",{staticClass:"title"},[t._v("价格")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.price,expression:"form.price"}],staticClass:"el-input__inner",attrs:{type:"number"},domProps:{value:t.form.price},on:{input:function(e){e.target.composing||t.$set(t.form,"price",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.price,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.price[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("运费")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.shipping_fee,expression:"form.shipping_fee"}],staticClass:"el-input__inner",attrs:{type:"number"},domProps:{value:t.form.shipping_fee},on:{input:function(e){e.target.composing||t.$set(t.form,"shipping_fee",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.shipping_fee,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.shipping_fee[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("库存")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.total,expression:"form.total"}],staticClass:"el-input__inner",attrs:{type:"number"},domProps:{value:t.form.total},on:{input:function(e){e.target.composing||t.$set(t.form,"total",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.total,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.total[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("销量")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sales,expression:"form.sales"}],staticClass:"el-input__inner",attrs:{type:"number"},domProps:{value:t.form.sales},on:{input:function(e){e.target.composing||t.$set(t.form,"sales",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.sales,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.sales[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("折扣")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.discount,expression:"form.discount"}],staticClass:"el-input__inner",attrs:{step:"0.01",type:"number"},domProps:{value:t.form.discount},on:{input:function(e){e.target.composing||t.$set(t.form,"discount",e.target.value)}}}),a("span",{staticClass:"error-list"},t._l(t.errors.discount,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.discount[r].msg))]):t._e()}),0)]),a("label",[a("span",{staticClass:"title"},[t._v("货到付款")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#aaa"},model:{value:t.form.cod,callback:function(e){t.$set(t.form,"cod",e)},expression:"form.cod"}})],1),a("label",[a("span",{staticClass:"title"},[t._v("热卖")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#aaa"},model:{value:t.form.is_hot,callback:function(e){t.$set(t.form,"is_hot",e)},expression:"form.is_hot"}})],1),a("label",[a("span",{staticClass:"title"},[t._v("新品")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#aaa"},model:{value:t.form.is_new,callback:function(e){t.$set(t.form,"is_new",e)},expression:"form.is_new"}})],1),a("label",[a("span",{staticClass:"title"},[t._v("轮播展示")]),a("el-switch",{attrs:{"active-color":"#13ce66","inactive-color":"#aaa"},model:{value:t.form.is_carousel,callback:function(e){t.$set(t.form,"is_carousel",e)},expression:"form.is_carousel"}})],1),t.form.is_carousel?a("div",[a("label",[a("span",{staticClass:"title"},[t._v("轮播图片")]),a("Uploader",{attrs:{autoUpload:!0},on:{uploadSuccess:t.carouselUploaded}})],1),t.form.carousel?a("img",{attrs:{src:t.fileUrl(t.form.carousel),alt:t.img.name}}):t._e()]):t._e(),a("label",[a("span",{staticClass:"title"},[t._v("独有属性")]),a("div",{staticClass:"row"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.propForm.key,expression:"propForm.key"}],staticClass:"even",attrs:{type:"text",placeholder:"名称"},domProps:{value:t.propForm.key},on:{input:function(e){e.target.composing||t.$set(t.propForm,"key",e.target.value)}}}),a("input",{directives:[{name:"model",rawName:"v-model",value:t.propForm.value,expression:"propForm.value"}],staticClass:"even",attrs:{type:"text",placeholder:"可选的值，请用|隔开"},domProps:{value:t.propForm.value},on:{input:function(e){e.target.composing||t.$set(t.propForm,"value",e.target.value)}}}),a("button",{attrs:{type:"button"},on:{click:t.addProp}},[t._v("完成")])]),t._l(t.form.prop,function(e,r){return a("div",{key:r,staticClass:"row"},[a("span",[t._v(t._s(r))]),t._v(":\n          "),a("span",[t._v(t._s(e))]),a("button",{attrs:{type:"button"},on:{click:function(e){return t.removeProp(r)}}},[t._v("-")]),a("button",{attrs:{type:"button"},on:{click:function(a){return t.fillPropForm(r,e)}}},[t._v("编辑")])])}),a("span",{staticClass:"error-list"},t._l(t.errors.total,function(e,r){return e?a("span",{key:r,staticClass:"error"},[t._v(t._s(t.rules.total[r].msg))]):t._e()}),0)],2),a("div",[a("label",[a("span",{staticClass:"title"},[t._v("主图")]),a("Uploader",{attrs:{autoUpload:!0},on:{uploadSuccess:t.singleCoverUploaded}})],1),a("el-row",t._l(t.form.main_img,function(e){return a("el-col",{key:e,staticClass:"thumbnail",attrs:{span:6}},[a("img",{attrs:{src:t.fileUrl(e),alt:e.name}}),a("div",[t._v(t._s(e._original_name))])])}),1)],1),a("div",[a("div",{staticClass:"title"},[t._v("详情描述")]),a("button",{attrs:{type:"button"},on:{click:function(e){return t.inertDesc("text")}}},[t._v("插入文字")]),a("button",{attrs:{type:"button"},on:{click:function(e){return t.inertDesc("image")}}},[t._v("插入图片")]),a("div",t._l(t.form.detail,function(e,r){return a("div",{key:r,staticClass:"segment"},[a("button",{attrs:{type:"button"},on:{click:function(e){return t.removeDesc(r)}}},[t._v("删除")]),"text"===e.type?a("div",{staticClass:"text"},[a("el-input",{attrs:{type:"textarea"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"it.value"}})],1):a("div",{staticClass:"image"},[a("Uploader",{attrs:{autoUpload:!0},on:{uploadSuccess:function(e){return t.singleDescImageUploaded(e,r)}}}),e.value?a("div",[a("img",{attrs:{src:t.fileUrl(e.value),alt:""}})]):t._e()],1)])}),0)]),a("label",[a("button",{staticClass:"el-button el-button--primary",attrs:{type:"submit"}},[t._v("提交")]),a("button",{staticClass:"el-button el-button--text",on:{click:function(e){t.ui.formVisible=!1}}},[t._v("取消")])])])]):t._e(),a("div",[a("h2",[t._v("列表")]),a("p",[t._v("总数："+t._s(t.total))]),a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.list,stripe:""}},[a("el-table-column",{attrs:{prop:"title",label:"标题",width:"180"}}),a("el-table-column",{attrs:{label:"主图",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.main_img,function(e){return a("div",{key:e,staticClass:"thumbnail"},[a("img",{attrs:{src:t.fileUrl(e),alt:e.name}}),a("div",[t._v(t._s(e._original_name))])])})}}])}),a("el-table-column",{attrs:{prop:"$cat.name",label:"分类",width:"180"}}),a("el-table-column",{attrs:{prop:"$brand.name",label:"品牌",width:"180"}}),a("el-table-column",{attrs:{prop:"price",label:"价格",width:"180"}}),a("el-table-column",{attrs:{prop:"shipping_fee",label:"运费",width:"180"}}),a("el-table-column",{attrs:{prop:"total",label:"库存",width:"180"}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.fill(e.row)}}},[t._v("更新")]),a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return t.remove(e.row.id)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"text-center"},[a("el-pagination",{attrs:{"page-size":t.readParam.limit,"current-page":t.readParam.page,layout:"prev, pager, next",total:t.total},on:{"current-change":t.flip}})],1)],1)])},Ma=[],Ea=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("input",{attrs:{type:"file"},on:{change:t.onFill}})])},Da=[],za={props:["autoUpload"],data:function(){return{file:null}},methods:{onFill:function(t){var e=this,a=t.target,r=this.file=a.files[0];if(r){var n=new FormData;if(n.append("file",r),this.$emit("change",r),this.autoUpload){var s=new FormData;s.append("file",r),M("_file/create",s).then(function(t){t.success?(a.value="",e.$emit("uploadSuccess",t.data)):e.$emit("uploadFail",t)})}}}}},Aa=za,Va=Object(X["a"])(Aa,Ea,Da,!1,null,null,null),La=Va.exports,Ra={components:{Uploader:La,Dropdown:xa},mixins:[ia],data:function(){return{model:"product",propForm:{key:"",value:""},readParam:{with:["belongs_to:cat","belongs_to:brand"]},rules:{title:{required:{msg:"标题为必填项"}},cat_id:{required:{msg:"分类为必填项"}},brand_id:{required:{msg:"品牌为必填项"}},price:{min:{params:[0],msg:"价格不可小于0"}},shipping_fee:{min:{params:[0],msg:"价格不可小于0"}},total:{min:{params:[0],msg:"价格不可小于0"}}}}},methods:{fileUrl:S,addProp:function(){var t=this.propForm,e=this.form,a=t.key,r=t.value;a&&r&&(e.prop||this.$set(e,"prop",{}),this.$set(e.prop,t.key,t.value),this.propForm={})},removeProp:function(t){this.$delete(this.form.prop,t)},fillPropForm:function(t,e){this.$set(this.propForm,"key",t),this.$set(this.propForm,"value",e)},carouselUploaded:function(t){this.form.carousel_img=t},singleCoverUploaded:function(t){console.log(t),this.form.main_img||this.$set(this.form,"main_img",[]),this.form.main_img.push(t)},singleDescImageUploaded:function(t,e){this.updateDesc(e,t)},inertDesc:function(t){this.form.detail||this.$set(this.form,"detail",[]),this.form.detail.push({type:t})},updateDesc:function(t,e){this.$set(this.form.detail[t],"value",e),console.log(this.form.detail)},removeDesc:function(t){this.form.detail.splice(t,1)}}},Ta=Ra,Ya=(a("c0fd"),Object(X["a"])(Ta,Ua,Ma,!1,null,"7634f0c9",null)),Ga=Ya.exports;window.api=M,r["default"].filter("cut",function(t,e){return t?(t=t.toString(),t.slice(0,e)+(t.length<=e?"":"...")):""}),r["default"].use(i.a),r["default"].use(n["a"]);var Qa=new n["a"]({routes:[{path:"/",component:Mt},{path:"/product/:id",component:Lt},{path:"/search",component:re},{path:"/login",component:ce},{path:"/signup",component:Pe},{path:"/recover",component:je},{path:"/my",component:De,children:[{path:"settings",component:Te},{path:"order/:id?",component:We}]},{path:"/admin",component:aa,children:[{path:"user",component:ua},{path:"order",component:ha},{path:"cat",component:qa},{path:"brand",component:Ia},{path:"product",component:Ga}]}]});Qa.beforeEach(function(t,e,a){var r="/admin"==t.matched[0].path,n=C.isAdmin();r&&!n||a()}),new r["default"]({router:Qa,render:function(t){return t(ht)}}).$mount("#app")},"609f":function(t,e,a){"use strict";var r=a("f0fa"),n=a.n(r);n.a},"64b4":function(t,e,a){"use strict";var r=a("baf3"),n=a.n(r);n.a},"790a":function(t,e,a){"use strict";var r=a("3b07"),n=a.n(r);n.a},"7c04":function(t,e,a){t.exports=a.p+"img/logo.942c3b62.png"},"814f":function(t,e,a){},9261:function(t,e,a){"use strict";var r=a("a4d1"),n=a.n(r);n.a},a4d1:function(t,e,a){},b2ef:function(t,e,a){},baf3:function(t,e,a){},c0fd:function(t,e,a){"use strict";var r=a("e7bd"),n=a.n(r);n.a},c954:function(t,e,a){},d9e2:function(t,e,a){"use strict";var r=a("b2ef"),n=a.n(r);n.a},e29e:function(t,e,a){},e7bd:function(t,e,a){},edde:function(t,e,a){t.exports=a.p+"img/logo@2x.eaf612fe.png"},f0fa:function(t,e,a){},f2e1:function(t,e,a){"use strict";var r=a("fe83"),n=a.n(r);n.a},f771:function(t,e,a){},fe83:function(t,e,a){}});
//# sourceMappingURL=app.9e5d51ae.js.map